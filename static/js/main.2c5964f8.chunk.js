(this.webpackJsonpminesweeper=this.webpackJsonpminesweeper||[]).push([[0],[,,,,,,,,,,,,,function(e,t,n){e.exports=n(22)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),o=n(9),l=n.n(o),r=(n(18),n(6)),s=n(2),c=n(3),u=n(7),d=n(5),m=(n(19),n(10)),h=(n(20),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).handleChange=function(e){var t=e.target,n=t.name,i=t.value;a.setState(Object(m.a)({},n,i))},a.handleSubmitStartNewGame=function(e){e.preventDefault();var t=a.state,n=t.columnsCount,i=t.rowsCount,o=t.minesCount;(0,a.props.handleStartNewGame)(Number(n),Number(i),Number(o))},a.state={columnsCount:10,rowsCount:10,minesCount:10,maxColumnsCount:500,maxRowsCount:500},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this.state,t=e.columnsCount,n=e.rowsCount,a=e.minesCount;(0,this.props.handleStartNewGame)(Number(t),Number(n),Number(a))}},{key:"render",value:function(){var e=this.state,t=e.columnsCount,n=e.rowsCount,a=e.minesCount,o=e.maxColumnsCount,l=e.maxRowsCount,r=t*n-1;return i.a.createElement("form",{name:"initGameSettings",className:"formInitGameSettings",action:"",onSubmit:this.handleSubmitStartNewGame},i.a.createElement("label",{htmlFor:"x"},"X:",i.a.createElement("input",{type:"number",name:"columnsCount",className:"fieldColumnsCount",min:"2",max:o,value:t,onChange:this.handleChange,required:!0})),i.a.createElement("label",{htmlFor:"y"},"Y:",i.a.createElement("input",{type:"number",name:"rowsCount",className:"fieldRowsCount",min:"2",max:l,value:n,onChange:this.handleChange,required:!0})),i.a.createElement("label",{htmlFor:"mines"},"Mines:",i.a.createElement("input",{type:"number",name:"minesCount",className:"fieldMinesCount",min:"1",max:r,value:a,onChange:this.handleChange,required:!0})),i.a.createElement("button",{type:"submit",className:"buttonStartGame"},"Play"))}}]),n}(i.a.PureComponent)),f=(n(21),{0:"",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",M:"\ud83d\udca3",ME:"\ud83d\udca3",C:"",F:"\ud83d\udea9",FW:"\u2715"}),g={0:"empty",1:"digit1",2:"digit2",3:"digit3",4:"digit4",5:"digit5",6:"digit6",7:"digit7",8:"digit8",M:"mine",ME:"mine mineExplosion",C:"closed",F:"closed flagged",FW:"flaggedWrong"},E={0:"empty",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",M:"mine",ME:"explosion mine",C:"closed",F:"flagged",FW:"wrong flagged"},v=function(e){var t=e.closedField,n=e.fieldIsDisable,a=e.boardHandles;return i.a.createElement("div",Object.assign({className:"fieldContainer"},a),t.map((function(e,t){return e.map((function(e,a){return i.a.createElement("button",{key:"Cell__".concat(a,"_").concat(t),"data-x":a,"data-y":t,className:"Cell ".concat(g[e]),disabled:n[t][a],"aria-label":E[e]},f[e])}))})))},C=n(11),N=n(12),p=function(e){return function(e,t){return Math.floor(e+Math.random()*(t+1-e))}(0,e-1)},y={ZERO_MINES_NEARBY:0,ONE_MINES_NEARBY:1,TWO_MINES_NEARBY:2,THREE_MINES_NEARBY:3,FOUR_MINES_NEARBY:4,FIVE_MINES_NEARBY:5,SIX_MINES_NEARBY:6,SEVEN_MINES_NEARBY:7,EIGHT_MINES_NEARBY:8,CELL_CLOSED:"C",MINE:"M",MINE_EXPLOSION:"ME",FLAG:"F",FLAG_IN_WRONG_POSITION:"FW"},_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(Object(s.a)(this,e),a>t*n)throw new Error("ERROR: mines more than cell");this.x=t,this.y=n,this.mines=a,this.field=[],this.closedField=[],this.leftFlags=a,this.leftClosed=t*n,this.gameState="non-started",this.mapDefinitionToSymbol=y}return Object(c.a)(e,[{key:"_initMines",value:function(){for(var e=this.mines;0!==e;){var t=p(this.x),n=p(this.y);this.field[n][t]!==y.MINE&&(this.field[n][t]=y.MINE,e-=1)}}},{key:"_getArea8",value:function(e,t){for(var n=[],a=t-1;a<=t+1;a+=1)for(var i=e-1;i<=e+1;i+=1)a>=0&&a<this.y&&i>=0&&i<this.x&&(e!==i||t!==a)&&n.push({x:i,y:a});return n}},{key:"_getArea8Closed",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getArea8(e,t);return a.filter((function(e){var t=e.x,a=e.y;return n.closedField[a][t]===y.CELL_CLOSED}))}},{key:"_getArea8Flagged",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getArea8(e,t);return a.filter((function(e){var t=e.x,a=e.y;return n.closedField[a][t]===y.FLAG}))}},{key:"_increaseMineCounterInArea8",value:function(e,t){var n=this;this._getArea8(e,t).forEach((function(e){var t=e.x,a=e.y,i=n.field[a][t];i!==y.MINE&&(n.field[a][t]=i+1)}))}},{key:"_calculateMinesAndSetCounterValues",value:function(){var e=this;this.field.forEach((function(t,n){return t.forEach((function(t,a){t===y.MINE&&e._increaseMineCounterInArea8(a,n)}))}))}},{key:"_initFieldAndFillValue",value:function(e){var t=this;return Array.from({length:this.y},(function(){return new Array(t.x).fill(e)}))}},{key:"init",value:function(){this.closedField=this._initFieldAndFillValue(y.CELL_CLOSED),this.field=this._initFieldAndFillValue(y.ZERO_MINES_NEARBY),this._initMines(),this._calculateMinesAndSetCounterValues(),this.gameState="playing"}},{key:"_markAllWrongFlag",value:function(){var e=this;this.closedField.forEach((function(t,n){return t.forEach((function(t,a){t===y.FLAG&&e.field[n][a]!==y.MINE&&(e.closedField[n][a]=y.FLAG_IN_WRONG_POSITION)}))}))}},{key:"_markAllTailClosedFlag",value:function(){var e=this;this.closedField.forEach((function(t,n){return t.forEach((function(t,a){t===y.CELL_CLOSED&&e.field[n][a]===y.MINE&&(e.closedField[n][a]=y.FLAG)}))}))}},{key:"_showAllClosedMine",value:function(){var e=this;this.closedField.forEach((function(t,n){return t.forEach((function(t,a){t===y.CELL_CLOSED&&e.field[n][a]===y.MINE&&(e.closedField[n][a]=y.MINE)}))}))}},{key:"_exitLoseExplosion",value:function(e,t){this.closedField[t][e]=y.MINE_EXPLOSION,this._markAllWrongFlag(),this._showAllClosedMine(),this.gameState="lose"}},{key:"_exitWinAllOpened",value:function(){this._markAllTailClosedFlag(),this.gameState="win"}},{key:"_openCell",value:function(e,t){this.leftClosed-=1,this.closedField[t][e]=this.field[t][e]}},{key:"stepToOpenCell",value:function(e,t){for(var n=Date.now(),a=new Set,i=[{x:e,y:t}];i.length>0;){var o=i.shift();if(o){var l=o.x,r=o.y;if(a.add("".concat(l,",").concat(r)),this.closedField[r][l]===y.CELL_CLOSED){if(this._openCell(l,r),this.field[r][l]===y.MINE){this._exitLoseExplosion(l,r);break}if(this.leftClosed===this.leftFlags){this._exitWinAllOpened();break}if(this.field[r][l]===y.ZERO_MINES_NEARBY){var s=this._getArea8Closed(l,r).filter((function(e){var t=e.x,n=e.y,i=!a.has("".concat(t,",").concat(n));return i&&a.add("".concat(t,",").concat(n)),i}));i.push.apply(i,Object(N.a)(s))}}}}console.log("stepToOpenCell ( x",e,", y",t,") end: ",Date.now()-n,"ms")}},{key:"_setFlag",value:function(e,t){this.leftFlags-=1,this.leftClosed-=1,this.closedField[t][e]=y.FLAG}},{key:"_removeFlag",value:function(e,t){this.leftFlags+=1,this.leftClosed+=1,this.closedField[t][e]=y.CELL_CLOSED}},{key:"setOrRemoveFlag",value:function(e,t){this.closedField[t][e]===y.CELL_CLOSED&&this.leftFlags>0?this._setFlag(e,t):this.closedField[t][e]===y.FLAG&&this._removeFlag(e,t)}},{key:"ifSafeSpaceOpenArea8",value:function(e,t){var n=this.closedField[t][e];if(Number.isInteger(n)&&n!==y.ZERO_MINES_NEARBY){var a=this._getArea8(e,t),i=this._getArea8Flagged(e,t,a),o=this._getArea8Closed(e,t,a);if(n===i.length){var l,r=Object(C.a)(o);try{for(r.s();!(l=r.n()).done;){var s=l.value,c=s.x,u=s.y;this.stepToOpenCell(c,u)}}catch(d){r.e(d)}finally{r.f()}}}}},{key:"getNearestNotZeroCell",value:function(e,t){if(!this.closedField[t]||this.closedField[t][e]!==y.ZERO_MINES_NEARBY)return null;var n=[],a=function(n,a){return Math.sqrt(Math.pow(n-e,2)+Math.pow(a-t,2))};if(this.closedField.forEach((function(e,t){return e.forEach((function(e,i){e!==y.ZERO_MINES_NEARBY&&n.push({x:i,y:t,distance:a(i,t)})}))})),0===n.length)return null;var i=n.sort((function(e,t){return e.distance-t.distance}));return Object(r.a)(i,1)[0]}}]),e}(),F=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e))._updateState=function(){a.setState({gameProcessState:a.game.gameState,closedField:a.game.closedField})},a._handleStartNewGame=function(e,t,n){a.game=new _(e,t,n),a.game.init(),document.documentElement.style.setProperty("--x",e),document.documentElement.style.setProperty("--y",t),a._updateState()},a.handleClick=function(e){var t=e.target;if(!t.classList.contains("Cell"))return!1;if(e.ctrlKey)return a.handleContextMenu(e);var n=t.dataset,i=n.x,o=n.y;0===e.button&&a.game.closedField[o][i]===a.game.mapDefinitionToSymbol.CELL_CLOSED?a.game.stepToOpenCell(Number(i),Number(o)):a.game.ifSafeSpaceOpenArea8(Number(i),Number(o)),a.setState({gameProcessState:a.game.gameState,closedField:a.game.closedField,activeCell:{x:i,y:o}})},a.handleContextMenu=function(e){e.preventDefault();var t=e.target;if(!t.classList.contains("Cell"))return!1;var n=t.dataset,i=n.x,o=n.y;a.game.setOrRemoveFlag(Number(i),Number(o)),a.setState({gameProcessState:a.game.gameState,closedField:a.game.closedField,activeCell:{x:i,y:o}})},a.handleKeyDownArrow=function(e){var t=e.target,n=e.key,i={ArrowUp:function(e,t){return[e,t-1]},ArrowDown:function(e,t){return[e,t+1]},ArrowLeft:function(e,t){return[e-1,t]},ArrowRight:function(e,t){return[e+1,t]}};if(Object.keys(i).includes(n)){var o=t.dataset,l=o.x,s=o.y,c=a.game,u=c.x,d=c.y,m=a.state.closedField;!function e(o,l){var s=i[n](o,l),c=Object(r.a)(s,2),h=c[0],f=c[1];if(!(h<0||h>=u||f<0||f>=d)){if(m[f][h]===a.game.mapDefinitionToSymbol.ZERO_MINES_NEARBY)return e(h,f);t.parentElement.children[h+f*u].focus()}}(Number(l),Number(s))}},a.state={gameProcessState:"no-started",closedField:[],activeCell:{x:0,y:0}},a.boardEl=i.a.createRef(),a}return Object(c.a)(n,[{key:"componentDidUpdate",value:function(){var e=this.state.activeCell,t=e.x,n=e.y,a=this.game.getNearestNotZeroCell(t,n);null!==a?document.querySelector(".fieldContainer").children[a.x+a.y*this.game.x].focus():this.game.leftClosed===this.game.x*this.game.y&&document.querySelector(".fieldContainer").children[0].focus()}},{key:"renderGameStatusMessage",value:function(){var e={win:i.a.createElement("span",{className:"messageWin"},"All opened right! You win!\ud83c\udfc6"),lose:i.a.createElement("span",{className:"messageLose"},"BOOM! Game Over! \u2620\ufe0f"),playing:null},t=this.state.gameProcessState,n=0===this.game.leftFlags?"messageFlags messageFlagsZero":"messageFlags";return i.a.createElement("div",{className:"message"},i.a.createElement("span",{className:n},"Flags: ",this.game.leftFlags," "),"of ",this.game.mines,". ",e[t])}},{key:"render",value:function(){var e=this,t=this.state,n=t.gameProcessState,a=t.closedField,o={onClick:this.handleClick,onMouseDown:this.handleClick,onContextMenu:this.handleContextMenu,onKeyDown:this.handleKeyDownArrow},l=a.map((function(t){return t.map((function(t){return"playing"!==n||t===e.game.mapDefinitionToSymbol.ZERO_MINES_NEARBY}))}));return i.a.createElement("div",{className:"App",onContextMenu:function(e){return e.preventDefault()}},i.a.createElement(h,{handleStartNewGame:this._handleStartNewGame}),"no-started"===n?null:i.a.createElement(i.a.Fragment,null,this.renderGameStatusMessage(),i.a.createElement(v,{closedField:a,fieldIsDisable:l,boardHandles:o})))}}]),n}(i.a.Component),S=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function b(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(F,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");S?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):b(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):b(t,e)}))}}()}],[[13,1,2]]]);
//# sourceMappingURL=main.2c5964f8.chunk.js.map